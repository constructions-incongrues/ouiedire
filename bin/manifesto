for manifest in $(find . -name manifest.json); do echo $manifest; cat $manifest | jq --arg playlist "$(<$(dirname $manifest)/playlist.html)" --arg description "$(<$(dirname $manifest)/description.html)" ". + {\"number\": \"$(echo $(basename $(dirname $manifest)) | sed -r 's/[a-z]+-([0-9]+)/\1/')\", \"type\": \"$(echo $(basename $(dirname $manifest)) | sed -r 's/([a-z]+)-[0-9]+/\1/')\", \"image\": \"$(basename $(find ./src/public/emission/$(basename $(dirname $manifest)) -name '*.png' -or -name '*.gif' -or -name '*.jpg' | head -1))\", \"description\": (\$description | @html), \"playlist\": (\$playlist | @html)}" | tee $(dirname $manifest)/manifest-new.json && mv $(dirname $manifest)/manifest-new.json $manifest; done;